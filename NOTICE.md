This code has been modified by Christopher-K-Long
